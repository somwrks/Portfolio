// components/AvatarPopup.tsx
"use client";
import React, { useState, useRef } from "react";
import { Button, Image, Link } from "@nextui-org/react";

interface AvatarPopupProps {
  isClosing: boolean;
  onClose: () => void;
}

export default function AvatarPopup({ isClosing, onClose }: AvatarPopupProps) {
  const [dragStart, setDragStart] = useState<number | null>(null);
  const [currentDrag, setCurrentDrag] = useState(0);
  const popupRef = useRef<HTMLDivElement>(null);

  const handleTouchStart = (e: React.TouchEvent | React.MouseEvent) => {
    const clientY = "touches" in e ? e.touches[0].clientY : e.clientY;
    setDragStart(clientY);
  };

  const handleTouchMove = (e: React.TouchEvent | React.MouseEvent) => {
    if (dragStart === null) return;
    const clientY = "touches" in e ? e.touches[0].clientY : e.clientY;
    const delta = clientY - dragStart;
    if (delta > 0) {
      setCurrentDrag(delta);
    }
  };

  const handleTouchEnd = () => {
    if (currentDrag > 150) {
      onClose();
    }
    setDragStart(null);
    setCurrentDrag(0);
  };

  return (
    <div
      ref={popupRef}
      className={`bg-[#0E0E0E] absolute z-50 w-11/12 justify-center items-center md:w-4/5 rounded-3xl px-6 pb-8 mt-4 bottom-0 min-h-[90vh] ${
        isClosing ? "slide-out" : "slide-in"
      }`}
      style={{
        transform: `translateY(${currentDrag}px)`,
        transition: dragStart ? "none" : "transform 0.3s ease-out",
      }}
      onClick={(e) => e.stopPropagation()}
    >
      <div
        className="w-full flex justify-center py-2 cursor-grab active:cursor-grabbing"
        onTouchStart={handleTouchStart}
        onTouchMove={handleTouchMove}
        onTouchEnd={handleTouchEnd}
        onMouseDown={handleTouchStart}
        onMouseMove={handleTouchMove}
        onMouseUp={handleTouchEnd}
        onMouseLeave={handleTouchEnd}
      >
        <div className="w-12 h-1.5 bg-gray-600 rounded-full" />
      </div>

      <div className="flex flex-col items-center gap-6 mt-4">
        <Image
          src="https://avatars.githubusercontent.com/u/85481905?v=4"
          alt="Profile"
          className="w-24 h-24 rounded-full"
        />
        <div className="text-center">
          <h2 className="text-2xl font-bold text-white">
            Aishwarya Srivastava
          </h2>
          <p className="text-gray-400">aka. Ash, Som</p>
        </div>
        <p className="text-gray-300 text-center">
          Currently exploring deep learning, quantum computing, or building next
          big things from the ground up, always looking to connect with
          passionate people!
        </p>
        <div className="flex gap-4 mt-4">
          <Link href="https://www.instagram.com/ashworks.dev/">
          <svg
            width="40"
            height="40"
            viewBox="0 0 40 40"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M39.8712 11.5664C39.8467 9.92184 39.5358 8.29029 38.9405 6.75215C37.8987 4.12559 35.7774 2.04867 33.092 1.03194C31.5393 0.460572 29.8978 0.154248 28.2363 0.119488C26.0995 0.0260702 25.422 0 19.9978 0C14.5735 0 13.8783 1.45678e-07 11.757 0.119488C10.0977 0.154248 8.45624 0.460572 6.9036 1.03194C4.21813 2.04867 2.09462 4.12559 1.05509 6.75215C0.470902 8.27073 0.155486 9.87622 0.124389 11.4991C0.028876 13.5912 0 14.2538 0 19.5591C0 24.8643 -1.65495e-08 25.5422 0.124389 27.6191C0.157708 29.2441 0.470902 30.8474 1.05509 32.3704C2.09685 34.9947 4.21813 37.0717 6.90582 38.0884C8.4518 38.6793 10.0933 39.0139 11.7592 39.066C13.8983 39.1594 14.5757 39.1877 20 39.1877C25.4243 39.1877 26.1195 39.1877 28.2408 39.066C29.9 39.0334 31.5415 38.7271 33.0964 38.1557C35.7819 37.1368 37.9032 35.0599 38.9449 32.4355C39.5291 30.9148 39.8423 29.3115 39.8756 27.6843C39.9711 25.5943 40 24.9317 40 19.6243C39.9956 14.319 39.9956 13.6455 39.8712 11.5664ZM19.9845 29.5917C14.3114 29.5917 9.71568 25.0968 9.71568 19.5482C9.71568 13.9996 14.3114 9.50472 19.9845 9.50472C25.653 9.50472 30.2532 13.9996 30.2532 19.5482C30.2532 25.0968 25.653 29.5917 19.9845 29.5917ZM30.6619 11.4752C29.3359 11.4752 28.2674 10.428 28.2674 9.13322C28.2674 7.83841 29.3359 6.79126 30.6619 6.79126C31.9836 6.79126 33.0542 7.83841 33.0542 9.13322C33.0542 10.428 31.9836 11.4752 30.6619 11.4752Z"
              fill="white"
            />
            <path
              d="M19.9845 26.0722C23.6684 26.0722 26.6548 23.1513 26.6548 19.5482C26.6548 15.9451 23.6684 13.0242 19.9845 13.0242C16.3005 13.0242 13.3141 15.9451 13.3141 19.5482C13.3141 23.1513 16.3005 26.0722 19.9845 26.0722Z"
              fill="white"
            />
          </svg>
</Link>
<Link href="https://x.com/ashworks1706">
          <svg
            width="40"
            height="40"
            viewBox="0 0 40 40"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M35.7143 0H4.28571C1.91964 0 0 1.91964 0 4.28571V35.7143C0 38.0804 1.91964 40 4.28571 40H35.7143C38.0804 40 40 38.0804 40 35.7143V4.28571C40 1.91964 38.0804 0 35.7143 0ZM31.3482 14.1786C31.3661 14.4286 31.3661 14.6875 31.3661 14.9375C31.3661 22.6786 25.4732 31.5982 14.7054 31.5982C11.3839 31.5982 8.30357 30.6339 5.71429 28.9732C6.1875 29.0268 6.64286 29.0446 7.125 29.0446C9.86607 29.0446 12.3839 28.1161 14.3929 26.5446C11.8214 26.4911 9.66072 24.8036 8.91964 22.4821C9.82143 22.6161 10.6339 22.6161 11.5625 22.375C8.88393 21.8304 6.875 19.4732 6.875 16.625V16.5536C7.65179 16.9911 8.5625 17.2589 9.51786 17.2946C8.71467 16.7604 8.05623 16.0356 7.60131 15.185C7.14639 14.3343 6.90914 13.3843 6.91071 12.4196C6.91071 11.3304 7.19643 10.3304 7.70536 9.46429C10.5893 13.0179 14.9196 15.3393 19.7768 15.5893C18.9464 11.6161 21.9196 8.39286 25.4911 8.39286C27.1786 8.39286 28.6964 9.09821 29.7679 10.2411C31.0893 9.99107 32.3571 9.5 33.4821 8.83036C33.0446 10.1875 32.125 11.3304 30.9107 12.0536C32.0893 11.9286 33.2321 11.5982 34.2857 11.1429C33.4911 12.3125 32.4911 13.3482 31.3482 14.1786Z"
              fill="white"
            />
          </svg>
          </Link>
<Link href="https://www.linkedin.com/in/ashworks/">
          <svg
            width="42"
            height="40"
            viewBox="0 0 42 40"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M39 0H2.99062C1.34062 0 0 1.29464 0 2.88393V37.1161C0 38.7054 1.34062 40 2.99062 40H39C40.65 40 42 38.7054 42 37.1161V2.88393C42 1.29464 40.65 0 39 0ZM12.6937 34.2857H6.46875V15.1964H12.7031V34.2857H12.6937ZM9.58125 12.5893C7.58437 12.5893 5.97188 11.0446 5.97188 9.15179C5.97188 7.25893 7.58437 5.71429 9.58125 5.71429C11.5687 5.71429 13.1906 7.25893 13.1906 9.15179C13.1906 11.0536 11.5781 12.5893 9.58125 12.5893ZM36.0281 34.2857H29.8031V25C29.8031 22.7857 29.7562 19.9375 26.5687 19.9375C23.325 19.9375 22.8281 22.3482 22.8281 24.8393V34.2857H16.6031V15.1964H22.575V17.8036H22.6594C23.4937 16.3036 25.5281 14.7232 28.5563 14.7232C34.8563 14.7232 36.0281 18.6786 36.0281 23.8214V34.2857Z"
              fill="white"
            />
          </svg>
          </Link>

<Link href="https://discord.gg/PRs84AnxtT">
          <svg
            width="40"
            height="46"
            viewBox="0 0 40 46"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M26.5371 21.7143C26.5371 23.1086 25.5086 24.2514 24.2057 24.2514C22.9257 24.2514 21.8743 23.1086 21.8743 21.7143C21.8743 20.32 22.9029 19.1771 24.2057 19.1771C25.5086 19.1771 26.5371 20.32 26.5371 21.7143ZM15.8629 19.1771C14.56 19.1771 13.5314 20.32 13.5314 21.7143C13.5314 23.1086 14.5829 24.2514 15.8629 24.2514C17.1657 24.2514 18.1943 23.1086 18.1943 21.7143C18.2171 20.32 17.1657 19.1771 15.8629 19.1771ZM40 4.70857V45.7143C34.2416 40.6255 36.0832 42.31 29.3943 36.0914L30.6057 40.32H4.68571C2.10286 40.32 0 38.2171 0 35.6114V4.70857C0 2.10286 2.10286 0 4.68571 0H35.3143C37.8971 0 40 2.10286 40 4.70857ZM33.4857 26.3771C33.4857 19.0171 30.1943 13.0514 30.1943 13.0514C26.9029 10.5829 23.7714 10.6514 23.7714 10.6514L23.4514 11.0171C27.3371 12.2057 29.1429 13.92 29.1429 13.92C23.7133 10.9442 17.3354 10.9437 12.0686 13.2571C11.2229 13.6457 10.72 13.92 10.72 13.92C10.72 13.92 12.6171 12.1143 16.7314 10.9257L16.5029 10.6514C16.5029 10.6514 13.3714 10.5829 10.08 13.0514C10.08 13.0514 6.78857 19.0171 6.78857 26.3771C6.78857 26.3771 8.70857 29.6914 13.76 29.8514C13.76 29.8514 14.6057 28.8229 15.2914 27.9543C12.3886 27.0857 11.2914 25.2571 11.2914 25.2571C11.6277 25.4925 12.1821 25.7976 12.2286 25.8286C16.0866 27.9891 21.5668 28.697 26.4914 26.6286C27.2914 26.3314 28.1829 25.8971 29.12 25.28C29.12 25.28 27.9771 27.1543 24.9829 28C25.6686 28.8686 26.4914 29.8514 26.4914 29.8514C31.5429 29.6914 33.4857 26.3771 33.4857 26.3771Z"
              fill="white"
            />
          </svg>
          </Link>
<Link href="mailto:ashworks1706@gmail.com">
          <svg
            width="40"
            className="mt-1"
            height="30"
            viewBox="0 0 40 30"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M39.2422 9.90625C39.5469 9.66406 40 9.89062 40 10.2734V26.25C40 28.3203 38.3203 30 36.25 30H3.75C1.67969 30 0 28.3203 0 26.25V10.2812C0 9.89062 0.445312 9.67188 0.757812 9.91406C2.50781 11.2734 4.82812 13 12.7969 18.7891C14.4453 19.9922 17.2266 22.5234 20 22.5078C22.7891 22.5312 25.625 19.9453 27.2109 18.7891C35.1797 13 37.4922 11.2656 39.2422 9.90625ZM20 20C21.8125 20.0312 24.4219 17.7188 25.7344 16.7656C36.1016 9.24219 36.8906 8.58594 39.2812 6.71094C39.7344 6.35937 40 5.8125 40 5.23438V3.75C40 1.67969 38.3203 0 36.25 0H3.75C1.67969 0 0 1.67969 0 3.75V5.23438C0 5.8125 0.265625 6.35156 0.71875 6.71094C3.10938 8.57812 3.89844 9.24219 14.2656 16.7656C15.5781 17.7188 18.1875 20.0312 20 20Z"
              fill="white"
            />
          </svg>
          </Link>

        </div>
      </div>
    </div>
  );
}
